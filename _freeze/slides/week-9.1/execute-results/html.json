{
  "hash": "4f4b10c61bcc453d8e55730360c62304",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Multiple Regression\ndate: today\ndate-format: long\nfooter: \"[DATS 1001 Website](https://ds4all.rocks)\"\nlogo: images/ds4all-logo.png\nformat:\n  revealjs:\n    theme: [simple, custom.scss]\n    transition: fade\n    slide-number: true\n    #multiplex: true\n    chalkboard: true\nexecute:\n  echo: true\n  message: false\n  warning: false\n  freeze: auto\n---\n\n\n\n## Load packages \n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(vdemdata)\n```\n:::\n\n\n\n\n## Load VDEM Data {.smaller}\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_data <- vdem |>\n  filter(year == 2006) |> \n  select(country_name, \n         libdem = v2x_libdem, \n         wealth = e_gdppc, \n         oil_rents = e_total_oil_income_pc,\n         polarization = v2cacamps, \n         corruption = v2x_corr, \n         judicial_review = v2jureview_ord, \n         region = e_regionpol_6C, \n         regime = v2x_regime) |> \n  mutate(\n         region = factor(\n           region,\n           labels=c(\"Eastern Europe\", \n             \"Latin America\", \n             \"MENA\", \n             \"SSAfrica\", \n             \"Western Europe and North America\", \n             \"Asia and Pacific\"))\n          )\n\nglimpse(model_data)\n```\n:::\n\n\n\n## Linear Model with Multiple Predictors\n\n<br>\n\n- Previously, we were interested in GDP per capita as a predictor of democracy\n- Now, let's consider another predictor: polarization (also measured by V-Dem)\n\n## Polarization Measure in the USA\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-9.1_files/figure-revealjs/polarization_usa-1.png){width=960}\n:::\n:::\n\n\n\n## Polarization and Democracy in 2006\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-9.1_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n\n## Model with One Predictor\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom) # for tidy() function\n\nlm(libdem ~ polarization, data = model_data) |> \n  tidy() # for nicer regression output\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.376     0.0187     20.1  2.66e-47\n2 polarization  -0.0914    0.0139     -6.58 5.30e-10\n```\n\n\n:::\n:::\n\n\n<br>\n\n| How do we interpret the intercept and the slope estimate?\n| Significance? \n\n## Model with Two Predictors\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(libdem ~ polarization + log(wealth), data = model_data) |> \n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic       p.value\n  <chr>           <dbl>     <dbl>     <dbl>         <dbl>\n1 (Intercept)    0.196     0.0340      5.76 0.0000000390 \n2 polarization  -0.0584    0.0138     -4.24 0.0000363    \n3 log(wealth)    0.0944    0.0151      6.24 0.00000000334\n```\n\n\n:::\n:::\n\n\n\n## Model with Two Predictors\n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc $$ \n\n$$ \\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc $$ \n\n## Model with Two Predictors \n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc $$ \n\n$$ \\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc $$ \n\n$a$ is the predicted level of Y when BOTH GDP per capita and polarization are equal to 0\n\n## Model with Two Predictors \n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc $$ \n\n$$ \\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc $$ \n\n- $b_1$ is the impact of a 1-unit change in polarization on the predicted level of Y, **holding GDP per capita fixed** (all else equal)\n- The relationship between polarization and democracy, controlling for wealth\n\n## Model with Two Predictors \n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc $$ \n\n$$ \\hat{Y_i} = 0.18 + -0.05*Polarization + 0.10*GDPpc $$ \n\n- $b_2$ is the impact of a 1-unit change in GDP per capita on the predicted level of Y, **holding polarization fixed** (all else equal)\n- The relationship between wealth and democracy, controlling for polarization\n\n## Model with Two Predictors\n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc $$ \n\n\n- OLS is searching for combination of $a$, $b_1$, and $b_2$ that minimize sum of squared residuals\n- Same logic as model with one predictor, just more complicated\n\n## Model with Three Predictors \n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc + b_3*OilRents $$ \n\n## Model with Three Predictors \n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(libdem ~ polarization + log(wealth) + oil_rents, data = model_data) |> \n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term           estimate  std.error statistic  p.value\n  <chr>             <dbl>      <dbl>     <dbl>    <dbl>\n1 (Intercept)   0.153     0.0317          4.82 3.30e- 6\n2 polarization -0.0577    0.0128         -4.50 1.32e- 5\n3 log(wealth)   0.131     0.0150          8.72 3.65e-15\n4 oil_rents    -0.0000413 0.00000607     -6.80 1.98e-10\n```\n\n\n:::\n:::\n\n\n\n## Model with Three Predictors {.smaller}\n\n<br>\n\n$$ \\hat{Y_i} = a + b_1*Polarization + b_2*GDPpc + b_3*OilRents $$ \n\n$$ \\hat{Y_i} = a + -.05*Polarization + .13*GDPpc + .00004*OilRents $$ \n<br>\n\n| $b_3$ is the impact of a 1-unit change in oil revenues per capita on the predicted level of Y, **holding polarization and GDP fixed** (all else equal)\n\n## Your Turn! {.smaller}\n\n<br>\n\n- In the last session, you examined levels of democracy and corruption\n- Now, let's fit a multiple regression model predicting corruption with two predictors: democracy (libdem) and polarization (polarization)\n- Then, interpret the coefficients\n- Estimate a second multiple regression model that adds in GDP per capita (lg_gdppc)\n- Interpret the coefficients\n- What happens to the coefficients of the other variables when we add GDP per capita to the model?\n    - Why do you think this happens?\n- Try adding in additional predictors if there is time\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer1\" data-update-every=\"1\" tabindex=\"0\" style=\"right:10%;bottom:10%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n\n## Model 1\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(corruption ~ libdem + polarization , data = model_data) |>\n      tidy() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.853     0.0267     32.0  9.12e-75\n2 libdem        -0.780     0.0592    -13.2  6.16e-28\n3 polarization   0.0459    0.0122      3.78 2.19e- 4\n```\n\n\n:::\n:::\n\n\n\n## Model 2 - Adding GDP per capita\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(corruption ~ libdem + polarization + log(wealth), data = model_data) |>\n      tidy() \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term         estimate std.error statistic  p.value\n  <chr>           <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    0.962     0.0278     34.6  1.25e-78\n2 libdem        -0.618     0.0574    -10.8  6.40e-21\n3 polarization   0.0298    0.0108      2.75 6.66e- 3\n4 log(wealth)   -0.0864    0.0125     -6.89 1.07e-10\n```\n\n\n:::\n:::\n\n\n\n# Categorical Variables\n\n## What is a Categorical Variable?\n\n<br>\n\n- A variable that represents distinct groups or categories\n- Categories can be named (e.g., \"Male\" or \"Female\") \n- Or numbered (e.g., 1, 2, 3)\n- Or words (like different regions)\n- Can be either nominal (unordered) or ordinal (ordered)\n- Also called \"dummy variables\" or \"indicator variables\"\n\n## What is a Factor in R?\n\n<br>\n\n- A data structure used to represent categorical variables\n- Can be dichotomous (binary) or have multiple levels\n- Supports both ordered and unordered categories\n- Call `factor()` to convert a variable to a factor\n- Call `levels()` to see the categories\n\n## Reference Categories\n\n<br>\n\n- In a regression model, every categorical variable needs a reference category\n- The reference category is the category that all other categories are compared to when interpreting the results\n- Call `relevel()` to change the reference category\n\n## Judicial Review and Democracy\n\n<br>\n\n**Judicial Review:**\n\n- Do high courts (Supreme Court, Constitutional Court, etc) have the power to rule on whether laws or policies are constitutional/legal? (Yes or No)\n- Dimension of Judicial Independence\n\n## Judicial Review and Democracy\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-9.1_files/figure-revealjs/judicial_review-1.png){width=960}\n:::\n:::\n\n\n\n## Judicial Review and Democracy\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(libdem ~ factor(judicial_review), data = model_data) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term                     estimate std.error statistic    p.value\n  <chr>                       <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)                 0.179    0.0493      3.64 0.000355  \n2 factor(judicial_review)1    0.267    0.0533      5.01 0.00000130\n```\n\n\n:::\n:::\n\n\n\n## Judicial Review and Democracy {.smaller}\n\n<br>\n\n$$ \\widehat{Democracy_{i}} = 0.17 + 0.28*JudicialReview(yes) $$\n\n- **Slope:** countries with judicial review are expected, on average, to be 0.28 units more democratic on the liberal democracy index\n  - Compares baseline level (Judicial Review = 0) to the other level (Judicial Review = 1)\n- **Intercept:** average democracy score of countries without judicial review\n- Average democracy score of countries with judicial review is 0.17 + 0.28 = 0.45\n\n## Dummy Variables\n\n<br>\n\n- When the categorical explanatory variable has many levels, they're encoded to **dummy variables** \n- We always leave one category out of the model, as the omitted reference category\n- Each coefficient describes is the expected difference between level of the factor **and the baseline level**\n- Everything is relative to the omitted reference category\n\n## Democracy and World Region\n\n<br>\n\n- Does region predict levels of democracy?\n- Since Eastern Europe is the first category, default in R is to use that as the omitted category in models.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(model_data$region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Eastern Europe\"                   \"Latin America\"                   \n[3] \"MENA\"                             \"SSAfrica\"                        \n[5] \"Western Europe and North America\" \"Asia and Pacific\"                \n```\n\n\n:::\n:::\n\n\n\n## Democracy and World Region {.smaller}\n\n<br>\n\nHow should we interpret intercept?  How about the coefficient on Latin America?\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(libdem ~ region, data = model_data) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  term                                   estimate std.error statistic  p.value\n  <chr>                                     <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                              0.434     0.0361     12.0  1.41e-24\n2 regionLatin America                      0.0664    0.0535      1.24 2.16e- 1\n3 regionMENA                              -0.236     0.0571     -4.13 5.63e- 5\n4 regionSSAfrica                          -0.139     0.0456     -3.06 2.61e- 3\n5 regionWestern Europe and North America   0.376     0.0541      6.94 7.84e-11\n6 regionAsia and Pacific                  -0.134     0.0519     -2.57 1.09e- 2\n```\n\n\n:::\n:::\n\n\n\n## Democracy and World Region {.smaller}\n\n<br>\n\nWhat if you want a different baseline category? How do we interpret now?\n\n<br>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make SS Africa the reference category\nmodel_data <- model_data |> \nmutate(newReg = relevel(region, ref=4)) \n\nlm(libdem ~ newReg, data = model_data) |>\n      tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  term                                   estimate std.error statistic  p.value\n  <chr>                                     <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                             0.295      0.0279    10.6   2.24e-20\n2 newRegEastern Europe                    0.139      0.0456     3.06  2.61e- 3\n3 newRegLatin America                     0.206      0.0484     4.25  3.47e- 5\n4 newRegMENA                             -0.0962     0.0523    -1.84  6.74e- 2\n5 newRegWestern Europe and North America  0.515      0.0491    10.5   3.36e-20\n6 newRegAsia and Pacific                  0.00582    0.0466     0.125 9.01e- 1\n```\n\n\n:::\n:::\n\n\n\n## Your Turn\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n \nV-Dem also includes a categorial regime variable: Closed autocracy (0), Electoral Autocracy (1), Electoral Democracy (2), Liberal Democracy (3)\n\n## Your Turn\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n\n \nFirst, let's make this an easier factor variable to work with.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Make nicer regime factor variable\nmodel_data <- model_data |> \n  mutate(regime = factor(regime,\n                         labels = c(\"Closed Autocracy\",\n                                   \"Electoral Autocracy\",\n                                  \"Electoral Democracy\",\n                                  \"Liberal Democracy\")))\nlevels(model_data$regime)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Closed Autocracy\"    \"Electoral Autocracy\" \"Electoral Democracy\"\n[4] \"Liberal Democracy\"  \n```\n\n\n:::\n:::\n\n\n\n## Your Turn {.smaller}\n\n<br>\n\n**Which types of regime have more corruption?**\n\n<br>\n\n- Filter data to include only the year 2019 (or run the code to use model_data)\n- Make a plot to visualize the relationship between regime type and level of corruption.          - Which kind of plot is best in this situation?\n- Fit a linear model\n- Interpret the intercept and coefficients\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer2\" data-update-every=\"1\" tabindex=\"0\" style=\"right:10%;bottom:10%;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">10</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n\n## Visualization\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week-9.1_files/figure-revealjs/corruption_plot-1.png){width=960}\n:::\n:::\n\n\n\n## Model\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(corruption ~ regime, data = model_data) |>\n      tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term                      estimate std.error statistic  p.value\n  <chr>                        <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                 0.598     0.0397     15.1  2.81e-33\n2 regimeElectoral Autocracy   0.151     0.0475      3.18 1.74e- 3\n3 regimeElectoral Democracy  -0.0606    0.0484     -1.25 2.11e- 1\n4 regimeLiberal Democracy    -0.469     0.0502     -9.35 4.46e-17\n```\n\n\n:::\n:::\n\n\n\n## Create Your Own Model {.smaller}\n\n<br>\n\n- What is a theory that you would like to test with V-Dem data?\n- What is the dependent variable? \n- What are the independent variables? \n- Map out steps to wrangle the data and fit a regression model\n- What do you expect to find? \n- Now go ahead and wrangle the data\n- Fit the model\n- Interpret the coefficients and their significance\n- Did the results match your expectations?",
    "supporting": [
      "week-9.1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}